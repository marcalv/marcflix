<!doctype html>
<html lang="en">
 
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarcFlix</title>
    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

</head>
 
<body>
    <div class="container">
        <h1>MarcFlix</h1>
        <h6>que web tan cutre</h6>
        <div class="my-4">
                <p>Status: <span id="uptimestatus"></span></p>
                <a id="statuson" class="btn btn-success" href="/api/alive/on">Encender</a>
                <a id="statusoff" class="btn btn-danger" href="/api/alive/off">Apagar</a>
        </div>
        
            

            <form action="/api/add" method="post">
                <div class="form-group">

                
                magnet: <input  type="text" name="magnet">
                <input class="btn btn-primary" type="submit" value="Submit">
            
                </div>
    </form> 
        <h3>Torrents</h3>
        <ul class="" id="torrentdiv">
            <!-- CONTENT -->
        </ul>

        <h3>Descargar</h3>
        <ul class="" id="filedownload">
                <!-- CONTENT -->
        </ul>

        <h3>Ver en Android</h3>
        <ul class="" id="filediv">
                <!-- CONTENT -->
        </ul>

        <h3>Ver en iPhone</h3>
        <ul class="" id="filedivios">
                <!-- CONTENT -->
        </ul>
    </div>

    

    
        <div class="myfooter mt-5">
            <p>Necesitas tener instalada la app VLC ðŸ‘‡ </p>
            <div class="row">
                    <div class="col-6">
                            <a href="https://play.google.com/store/apps/details?id=org.videolan.vlc"><img src="//www.videolan.org/images/get_it_on_play_logo_large.png" class="img-fluid" ></a>

                    </div>
                    <div class="col-6">
                            <a href="https://itunes.apple.com/app/apple-store/id650377962?pt=454758&amp;ct=vodownloadpage&amp;mt=8"><img src="//images.videolan.org/images/appstoredownload-en.png" class="img-fluid" ></a>
                        </div>
                  </div>
        </div>
      
     
      
    


</body>


<style>
.myfooter {
  
  padding: 1rem;
  background-color: #efefef;
  text-align: center;

}
img {
    max-height: 201px !important;
    width: auto;
}

</style>


<script>
    const TorrentItem = ({ torrent }) => `
    <li id="${torrent.infoHash}" class="">
            ${torrent.progress}% - ${torrent.name} 
    </li>
`;

const FileItemAndroid = ({ file }) => `
    <li class="">
            <a href=intent://${file.url.replace("http://","").replace("https://","")}#Intent;scheme=http;type=video/*;end ">${file.name}</a>
    </li>
`;

const FileItemIos = ({ file }) => `
    <li class="">
            <a href="vlc-x-callback://x-callback-url/stream?url=${file.url}">${file.name}</a>
    </li>
`;

const FileItemDownload = ({ file }) => `
    <li class="">
            <a href="${file.url}">${file.name}</a>
    </li>
`;

updateinfo()
window.setInterval(function () {
    updateinfo()
  }, 10000);

  function updateinfo(){
      
      
      
      
    $.getJSON('/api/info', function(data){
                    console.log('Received data')
                    console.log(data)

                    //Uptime robot status
                    status = data.UptimeRobotStatus
                    
                    if (status == '0'){
                        text = "apagado"
                        $("#statuson").show()
                        $("#statusoff").hide()
                    }else{
                        text = "encendido"
                        $("#statuson").hide()
                        $("#statusoff").show()
                    }
                    $("#uptimestatus").text(text)

                    //Add items to sourceBlock
                    $("#torrentdiv").empty();
                    data.torrentsInfo.forEach((torrent)=>{
                        console.log(torrent.name)
                        itemBlock = TorrentItem({ torrent: torrent})
                        $('#torrentdiv').append(itemBlock)
                    });

                    $("#filediv").empty();
                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemAndroid({ file: file})
                        $('#filediv').append(itemBlock)
                    });
                    
                    $("#filedivios").empty();
                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemIos({ file: file})
                        $('#filedivios').append(itemBlock)
                    });
                    
                    $("#filedownload").empty();
                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemDownload({ file: file})
                        $('#filedownload').append(itemBlock)
                    });
                    
                 });

  }




    
</script>
 
</html>