<!doctype html>
<html lang="en">
 
<head>
    <title>My Torrents</title>
    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>

</head>
 
<body>
    <h1>My Torrents</h1>
    <form action="/api/add" method="post">
        magnet: <input type="text" name="magnet">
        <input type="submit" value="Submit">
      </form> 

    <h3>Torrents</h3>
    <ul class="" id="torrentdiv">
        <!-- CONTENT -->
    </ul>

    <h3>Android - Files</h3>
    <ul class="" id="filediv">
            <!-- CONTENT -->
    </ul>

    <h3>iPhone - Files</h3>
    <ul class="" id="filedivios">
            <!-- CONTENT -->
    </ul>




</body>





<script>
    const TorrentItem = ({ torrent }) => `
    <li class="">
            ${torrent.progress}% - ${torrent.name} 
    </li>
`;

const FileItemAndroid = ({ file }) => `
    <li class="">
            <a href=intent://${file.url.replace("http://","").replace("https://","")}#Intent;scheme=http;type=video/*;end ">${file.name}</a>
    </li>
`;

const FileItemIos = ({ file }) => `
    <li class="">
            <a href="vlc-x-callback://x-callback-url/stream?url=${file.url}">${file.name}</a>
    </li>
`;


$.getJSON('/api/info', function(data){
                    console.log('Received data')
                    console.log(data)
                    //Add items to sourceBlock
                    data.torrentsInfo.forEach((torrent)=>{
                        console.log(torrent.name)
                        itemBlock = TorrentItem({ torrent: torrent})
                        $('#torrentdiv').append(itemBlock)
                    });


                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemAndroid({ file: file})
                        $('#filediv').append(itemBlock)
                    });

                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemIos({ file: file})
                        $('#filedivios').append(itemBlock)
                    });
                    
                 });
</script>
 
</html>