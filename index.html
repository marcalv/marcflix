<!doctype html>
<html lang="en">
 
<head>
    <title>My Torrents</title>
    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

</head>
 
<body>
    <div class="container-fluid">
        <h1>Mis torrents</h1>
        <h6>que cutre es esta web</h6>
        
            <form action="/api/add" method="post">
                <div class="form-group"></div>
                magnet: <input type="text" name="magnet">
                <input type="submit" value="Submit">
            
        </div>
    </form> 
        <h3>Torrents</h3>
        <ul class="" id="torrentdiv">
            <!-- CONTENT -->
        </ul>

        <h3>Descargar</h3>
        <ul class="" id="filedownload">
                <!-- CONTENT -->
        </ul>

        <h3>Ver en Android</h3>
        <ul class="" id="filediv">
                <!-- CONTENT -->
        </ul>

        <h3>Ver en iPhone</h3>
        <ul class="" id="filedivios">
                <!-- CONTENT -->
        </ul>
    </div>



</body>





<script>
    const TorrentItem = ({ torrent }) => `
    <li class="">
            ${torrent.progress}% - ${torrent.name} 
    </li>
`;

const FileItemAndroid = ({ file }) => `
    <li class="">
            <a href=intent://${file.url.replace("http://","").replace("https://","")}#Intent;scheme=http;type=video/*;end ">${file.name}</a>
    </li>
`;

const FileItemIos = ({ file }) => `
    <li class="">
            <a href="vlc-x-callback://x-callback-url/stream?url=${file.url}">${file.name}</a>
    </li>
`;

const FileItemDownload = ({ file }) => `
    <li class="">
            <a href="${file.url}">${file.name}</a>
    </li>
`;


$.getJSON('/api/info', function(data){
                    console.log('Received data')
                    console.log(data)
                    //Add items to sourceBlock
                    data.torrentsInfo.forEach((torrent)=>{
                        console.log(torrent.name)
                        itemBlock = TorrentItem({ torrent: torrent})
                        $('#torrentdiv').append(itemBlock)
                    });


                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemAndroid({ file: file})
                        $('#filediv').append(itemBlock)
                    });

                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemIos({ file: file})
                        $('#filedivios').append(itemBlock)
                    });

                    data.links.forEach((file)=>{
                        console.log(file.name)
                        itemBlock = FileItemDownload({ file: file})
                        $('#filedownload').append(itemBlock)
                    });
                    
                 });
</script>
 
</html>